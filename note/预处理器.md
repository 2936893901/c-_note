# 预处理器

- 预处理程序是指令，它们向编译器提供指令，以在实际编译开始之前对信息进行预处理。

- 所有预处理程序指令均以＃开头，并且一行上的预处理程序指令之前只能出现空格字符。**预处理程序指令不是C ++语句，因此它们不以分号（;）结尾**。



****

## `#define`预处理器

- `#define`预处理程序指令创建符号常量。符号常量称为**宏**，指令的一般形式为-

    ```c++
#define macro_name replacement-text 
    ```

- 当该行出现在文件中时，在编译程序之前，该文件中所有随后出现的宏都将由替换文本替换。

  ```c++
  #include <iostream>
  #define pi 3.1415;
  
  using namespace std;
  
  int main()
  {
      cout << pi;
      return 0;
  }
  ```



****

## 函数宏

- 您可以使用#define定义一个宏

```c++
#include <iostream>

#define Min(a, b) ((a < b) ? a : b)

using namespace std;

int main()
{
    cout << Min(10,20);
    return 0;
}
```



****

## 条件编译

- 可用于编译程序源代码的选择性部分。此过程称为条件编译

```c++
#ifdef 标识符
#ifndef 标识符
```

- 等价于

```c++
#if defined 标识符
#if !defined 标识符
```



<u>源文件中的每个 **`#if`**指令必须通过关闭 **`#endif`**指令来匹配。 **`#If`**和 **`#endif`**指令之间可以出现任意数量的 **`#elif`**指令，但最多允许一个 **`#else`**指令。 **`#else`**指令（如果有）必须是 **`#endif`**前的最后一个指令。</u>

<u>**`#if`**、 **`#elif`**、 **`#else`**和 **`#endif`**指令可以嵌套在其他 **`#if`**指令的*文本*部分中。 每个嵌套的 **`#else`**、 **`#elif`**或 **`#endif`**指令属于最近的 **`#if`**指令。</u>



****

## 预处理器运算符



### 字符串化运算符 (#)

- 数字符号或 "字符串化" 运算符 ( **#** ) 将宏参数转换为字符串文本, 而无需展开参数定义。 它仅用于采用参数的宏。 如果它在宏定义中位于形式参数之前，则由宏调用传递的实际自变量将用引号引起来并被视为字符串。 字符串随后替换宏定义中的字符串化运算符和形参的组合的每个匹配项。



### 加单引号运算符 (#@)

- 加单引号运算符只能与宏的自变量一起使用，如果`#@`在宏的定义中的形参前面加上实参, 则在展开宏时, 实参将括在单引号中并被视为一个字符。

```c++
#define makechar(x) #@x
```

- 导致一下语句

```c++
a = makechar(b);
```

- 结果为

```c++
a = 'b'
```



### 标记粘贴运算符 (# #)

- 双数字符号或标记粘贴操作符(##)，有时也称为合并或组合操作符，用于类对象宏和类函数宏。它允许将单独的令牌连接到单个令牌中，因此不能是宏定义中的第一个或最后一个令牌。



```c++
#include <iostream>

using namespace std;

#define MKSTR(x) #x

int main()
{
    cout << MKSTR(hello c++) << endl;
    return 0;
}
```



- \##运算符用于连接两个标记。

```c++
#include <iostream>
using namespace std;

#define concat(a, b) a##b

int main()
{
    int xy = 100;
    cout << cocat(x, y);
    return 0;
}
```

****



## 预定义的宏

- c++提供了许多下面提到的预定义宏

|     宏     | 描述                                                         |
| :--------: | :----------------------------------------------------------- |
| `__LINE__` | 它包含程序在编译时的当前行号。                               |
| `__FILE__` | 它包含正在编译的程序的当前文件名。                           |
| `__DATE__` | 它包含一个格式为`month / day / year`的字符串，该字符串是源文件转换为目标代码的日期。 |
| `__TIME__` | 它包含格式为`hour：minute：second`的字符串，该字符串是程序被编译的时间。 |

<u>注意：前后都是两个下划线</u>



```c++
#include <iostream>
using namespace std;

int main()
{
    cout << "__LINE__ value is " << __LINE__;
    return 0;
}
```

